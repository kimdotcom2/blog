# 위클리 페이퍼 14

## Spring 기반 웹 애플리케이션에서 발생할 수 있는 4가지 주요 보안 공격 (CSRF, XSS, 세션 고정, JWT 탈취)에 대해 설명하고, 각각에 대한 Spring Security 또는 일반적인 대응 전략을 설명하세요.

### CSRF (Cross-Site Request Forgery)

CSRF 공격은 사용자가 인증된 상태에서 악의적인 사이트를 방문할 때, 해당 사이트가 사용자의 권한을 이용해 원하지 않는 요청을 보내는 공격이다.

**대응 전략:**
1. Spring Security는 CSRF 보호를 기본적으로 활성화한다. CSRF 토큰을 생성하고, 폼 제출 시 이를 검증하여 요청의 유효성을 확인한다.
2. AJAX 요청의 경우, CSRF 토큰을 헤더에 포함시켜 서버로 전송해야 한다.

### XSS (Cross-Site Scripting)

XSS 공격은 악의적인 스크립트가 웹 페이지에 삽입되어 다른 사용자의 브라우저에서 실행되는 공격이다. 
이를 통해 세션 탈취, 쿠키 조작 등이 발생할 수 있다.

**대응 전략:**
1. 입력 값 검증 및 인코딩: 사용자 입력을 철저히 검증하고, 출력 시 HTML 인코딩을 적용하여 스크립트 실행을 방지한다.
2. Content Security Policy (CSP) 설정: CSP 헤더를 통해 허용된 스크립트 소스만 실행되도록 제한한다.

### 세션 고정 (Session Fixation)

세션 고정 공격은 공격자가 미리 생성한 세션 ID를 사용자가 로그인할 때까지 유지시키는 공격이다. 사용자가 로그인하면 
공격자는 동일한 세션 ID를 사용하여 인증된 세션에 접근할 수 있다.

**대응 전략:**
1. 로그인 시 새로운 세션 ID를 발급하여 세션 고정을 방지한다.
2. Spring Security는 기본적으로 로그인 시 세션을 무효화하고 새로운 세션을 생성한다.

### JWT 탈취

JWT 탈취 공격은 공격자가 네트워크를 통해 전송되는 JWT 토큰을 가로채어 인증된 사용자로 가장하는 공격이다.

**대응 전략:**
1. HTTPS 사용: JWT 토큰이 전송될 때 암호화된 채널을 사용하여 탈취 위험을 줄인다.
2. 토큰 만료 시간 설정: JWT 토큰에 적절한 만료 시간을 설정하여 탈취된 토큰의 유효 기간을 제한한다.
3. 토큰 저장 위치: JWT 토큰을 로컬 스토리지 대신 HttpOnly 쿠키에 저장하여 XSS 공격으로부터 보호한다.

## JWT(JSON Web Token)의 구조와 각 구성 요소가 어떤 역할을 하는지 구체적으로 설명하세요.

JWT는 세 부분으로 구성된 토큰으로, 각각은 점(.)으로 구분된다: 헤더(Header), 페이로드(Payload), 서명(Signature).

1. 헤더(Header):
헤더는 토큰의 유형과 사용된 서명 알고리즘을 지정한다. 예를 들어, 헤더는 다음과 같이 구성될 수 있다:
```json
{
  "alg": "HS256",
  "typ": "JWT"
}
//"alg"는 서명에 사용된 알고리즘을 나타내고, "typ"는 토큰의 유형을 나타낸다.
```

2. 페이로드(Payload):
페이로드는 토큰에 담길 클레임(Claims)을 포함한다. 클레임은 토큰에 대한 정보(예: 사용자 ID, 권한 등)를 담고 있다. 페이로드는 다음과 같이 구성될 수 있다:
```json
{
  "sub": "1234567890",
  "name": "John Doe",
  "iat": 1516239022
}
//"sub"는 주체(사용자)를 식별하는 클레임, "name"은 사용자 이름, "iat"는 토큰이 발급된 시간을 나타낸다.
``` 
3. 서명(Signature):
서명은 헤더와 페이로드를 기반으로 생성되며, 토큰의 무결성을 보장한다. 서명은 다음과 같은 방식으로 생성된다:
```HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret)
```
//서명은 헤더와 페이로드를 인코딩한 후 비밀 키를 사용하여 생성된다. 이를 통해 토큰이 변조되지 않았음을 확인할 수 있다.
JWT는 이러한 세 부분을 점(.)으로 연결하여 최종 토큰을 형성한다:
```
xxxxx.yyyyy.zzzzz
```
여기서 "xxxxx"는 인코딩된 헤더, "yyyyy"는 인코딩된 페이로드, "zzzzz"는 서명이다. JWT는 주로 인증 및 정보 교환에 사용되며, 각 구성 요소는 토큰의 신뢰성과 무결성을 보장하는 데 중요한 역할을 한다.    


